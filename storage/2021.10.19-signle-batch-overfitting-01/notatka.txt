niestabilnie z jakiegos powodu - jedyna zmiana to dodanie zapisywania loss√≥w za pomoca `.cpu().detach()`